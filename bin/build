#!/bin/bash

rm -r build/*
rm -r lib/*
rm -r lib_test/*
touch build/_placeholder
touch lib/_placeholder
touch lib_test/_placeholder
echo "Cleared old builds"

lessc less/all.less > build/reform.css
echo "Compiled LESS"

lessc less/theme-pure.less > build/reform-pure.css
echo "Compiled Pure LESS"

coffee -o lib src
echo "Compiled lib"

browserify -e lib/init.js -o build/reform.js -i "jquery-commonjs"
echo "Compiled standalone"

uglifyjs -o build/reform.min.js build/reform.js
echo "Minified standalone"

coffee -o lib_test test
echo "Compiled test libs"

browserify -e lib_test/test.js -o build/test.js -i "jquery-commonjs"
echo "Compiled tests"

echo "All done :)"